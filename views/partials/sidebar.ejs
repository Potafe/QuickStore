<button
  data-drawer-target="logo-sidebar"
  data-drawer-toggle="logo-sidebar"
  aria-controls="logo-sidebar"
  type="button"
  class="inline-flex items-center p-2 mt-2 ms-3 text-sm text-gray-500 rounded-lg sm:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600"
>
  <span class="sr-only">Open sidebar</span>
  <svg
    class="w-6 h-6"
    aria-hidden="true"
    fill="currentColor"
    viewBox="0 0 20 20"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      clip-rule="evenodd"
      fill-rule="evenodd"
      d="M2 4.75A.75.75 0 012.75 4h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 4.75zm0 10.5a.75.75 0 01.75-.75h7.5a.75.75 0 010 1.5h-7.5a.75.75 0 01-.75-.75zM2 10a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 10z"
    ></path>
  </svg>
</button>

<aside
  id="logo-sidebar"
  class="fixed top-0 left-0 z-40 w-64 h-screen transition-transform -translate-x-full sm:translate-x-0"
  aria-label="Sidebar"
>
  <div class="h-full px-3 py-4 overflow-y-auto bg-gray-50 dark:bg-gray-800">
    <a href="/" class="flex items-center ps-2.5 mb-5">
      <img
        src="../images/top-secret.png"
        class="h-7 me-3 sm:h-12"
        alt="QuickStore Logo"
      />
      <span
        class="self-center text-xl font-semibold whitespace-nowrap dark:text-white"
        >QuickStore</span
      >
    </a>

    <% if(locals.folder){ %>
    <div class="flex p-2 mb-2 items-center text-xl font-medium">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        style="fill: rgba(0, 0, 0, 1)"
      >
        <path
          d="M20 5h-9.586L8.707 3.293A.997.997 0 0 0 8 3H4c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h16c1.103 0 2-.897 2-2V7c0-1.103-.897-2-2-2z"
        ></path>
      </svg>
      <h2 class="ms-2.5"><%= folder.name %></h2>
    </div>
    <% } %>

    <hr />

    <ul class="space-y-2 font-medium flex flex-col">
      <li>
        <a
          href="/"
          class="flex items-center p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group"
        >
          <svg
            class="w-7 h-7 text-gray-500 transition duration-75 dark:text-gray-400 group-hover:text-gray-900 dark:group-hover:text-white"
            aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            fill="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              fill-rule="evenodd"
              d="M11.293 3.293a1 1 0 0 1 1.414 0l6 6 2 2a1 1 0 0 1-1.414 1.414L19 12.414V19a2 2 0 0 1-2 2h-3a1 1 0 0 1-1-1v-3h-2v3a1 1 0 0 1-1 1H7a2 2 0 0 1-2-2v-6.586l-.293.293a1 1 0 0 1-1.414-1.414l2-2 6-6Z"
              clip-rule="evenodd"
            />
          </svg>
          <span class="ms-3">Home</span>
        </a>
      </li>

      <li>
        <a
          href="/folders"
          class="flex items-center p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group"
        >
          <svg
            class="w-7 h-7 text-gray-500 transition duration-75 dark:text-gray-400 group-hover:text-gray-900 dark:group-hover:text-white"
            aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            fill="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              fill-rule="evenodd"
              d="M6 5a2 2 0 0 1 2-2h4.157a2 2 0 0 1 1.656.879L15.249 6H19a2 2 0 0 1 2 2v7a2 2 0 0 1-2 2v-5a3 3 0 0 0-3-3h-3.22l-1.14-1.682A3 3 0 0 0 9.157 6H6V5Z"
              clip-rule="evenodd"
            />
            <path
              fill-rule="evenodd"
              d="M3 9a2 2 0 0 1 2-2h4.157a2 2 0 0 1 1.656.879L12.249 10H3V9Zm0 3v7a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2v-7H3Z"
              clip-rule="evenodd"
            />
          </svg>

          <span class="flex-1 ms-3 whitespace-nowrap">My folders</span>
        </a>
      </li>
      <% if(locals.folder) { %>
      <li>
        <form
          action="/upload/<%= folder.id %>"
          method="post"
          enctype="multipart/form-data"
          id="uploadForm"
        >
          <button
            type="button"
            class="flex items-center gap-2 text-gray-900 bg-gradient-to-r from-teal-200 to-lime-200 hover:bg-gradient-to-l hover:from-teal-200 hover:to-lime-200 focus:ring-4 focus:outline-none focus:ring-lime-200 dark:focus:ring-teal-700 font-medium rounded-lg text-sm px-5 py-2.5 text-center me-2 mb-2"
          >
            <svg
              class="w-6 h-6 text-gray-800 dark:text-white mr-3"
              aria-hidden="true"
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              fill="none"
              viewBox="0 0 24 24"
            >
              <path
                stroke="currentColor"
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M12 5v9m-5 0H5a1 1 0 0 0-1 1v4a1 1 0 0 0 1 1h14a1 1 0 0 0 1-1v-4a1 1 0 0 0-1-1h-2M8 9l4-5 4 5m1 8h.01"
              />
            </svg>
            <label for="file">Upload file</label>
          </button>
          <input
            class="hidden"
            type="file"
            name="file"
            id="file"
            onchange="submitForm()"
          />
        </form>
      </li>
      <li>
        <button
          type="button"
          onclick="showNewFolderForm()"
          class="flex items-center gap-2 text-gray-900 bg-gradient-to-r from-red-200 via-red-300 to-yellow-200 hover:bg-gradient-to-bl focus:ring-4 focus:outline-none focus:ring-red-100 dark:focus:ring-red-400 font-medium rounded-lg text-sm px-5 py-2.5 text-center me-2 mb-2"
          aria-hidden="true"
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          fill="none"
          viewBox="0 0 24 24"
        >
          <svg
            class="w-6 h-6 text-gray-800 dark:text-white mr-3"
            aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            fill="none"
            viewBox="0 0 24 24"
          >
            <path
              stroke="currentColor"
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M14 8H4m8 3.5v5M9.5 14h5M4 6v13a1 1 0 0 0 1 1h14a1 1 0 0 0 1-1V9a1 1 0 0 0-1-1h-5.032a1 1 0 0 1-.768-.36l-1.9-2.28a1 1 0 0 0-.768-.36H5a1 1 0 0 0-1 1Z"
            />
          </svg>
          New folder
        </button>
      </li>
      <% if(folder.name !='Home' ){ %>
      <li>
        <button
          type="button"
          onclick="showRenameFolderForm()"
          class="flex items-center gap-2 text-white bg-gradient-to-br from-purple-600 to-blue-500 hover:bg-gradient-to-bl focus:ring-4 focus:outline-none focus:ring-blue-300 dark:focus:ring-blue-800 font-medium rounded-lg text-sm px-5 py-2.5 text-center me-2 mb-2"
          aria-hidden="true"
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          fill="none"
          viewBox="0 0 24 24"
        >
          <svg
            class="w-6 h-6 text-gray-800 dark:text-white"
            aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            fill="none"
            viewBox="0 0 24 24"
          >
            <path
              stroke="currentColor"
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="m14.304 4.844 2.852 2.852M7 7H4a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h11a1 1 0 0 0 1-1v-4.5m2.409-9.91a2.017 2.017 0 0 1 0 2.853l-6.844 6.844L8 14l.713-3.565 6.844-6.844a2.015 2.015 0 0 1 2.852 0Z"
            />
          </svg>
          Rename folder
        </button>
      </li>
      <li>
        <button
          type="button"
          onclick="showDeleteFolderForm()"
          class="flex items-center gap-2 text-white bg-gradient-to-r from-red-400 via-red-500 to-red-600 hover:bg-gradient-to-br focus:ring-4 focus:outline-none focus:ring-red-300 dark:focus:ring-red-800 shadow-lg shadow-red-500/50 dark:shadow-lg dark:shadow-red-800/80 font-medium rounded-lg text-sm px-5 py-2.5 text-center me-2 mb-2"
          aria-hidden="true"
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          fill="none"
          viewBox="0 0 24 24"
        >
          <svg
            class="w-6 h-6 text-gray-800 dark:text-white mr-3"
            aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            fill="none"
            viewBox="0 0 24 24"
          >
            <path
              stroke="currentColor"
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="m15 9-6 6m0-6 6 6m6-3a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"
            />
          </svg>
          Delete folder
        </button>
      </li>
      <% } %> <% } %>

      <li>
        <a
          href="/logout"
          class="flex items-center p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group"
        >
          <svg
            class="flex-shrink-0 w-5 h-5 text-gray-500 transition duration-75 dark:text-gray-400 group-hover:text-gray-900 dark:group-hover:text-white"
            aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 18 16"
          >
            <path
              stroke="currentColor"
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M1 8h11m0 0L8 4m4 4-4 4m4-11h3a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-3"
            />
          </svg>
          <span class="flex-1 ms-3 whitespace-nowrap">Sign Out</span>
        </a>
      </li>
    </ul>
  </div>
</aside>

<div
  id="newFolderFormContainer"
  class="hidden fixed inset-0 flex items-center justify-center bg-gray-900 bg-opacity-50"
>
  <form
    id="newFolderForm"
    method="post"
    class="relative flex flex-col bg-white p-6 rounded-lg shadow-md"
  >
    <button
      type="button"
      onclick="hideNewFolderForm()"
      class="absolute top-2 right-2 text-gray-500 hover:text-gray-700 focus:outline-none"
    >
      <svg
        class="w-8 h-8"
        aria-hidden="true"
        fill="currentColor"
        viewBox="0 0 20 20"
      >
        <path
          fill-rule="evenodd"
          d="M6.293 6.293a1 1 0 0 1 1.414 0L10 8.586l2.293-2.293a1 1 0 1 1 1.414 1.414L11.414 10l2.293 2.293a1 1 0 0 1-1.414 1.414L10 11.414l-2.293 2.293a1 1 0 0 1-1.414-1.414L8.586 10 6.293 7.707a1 1 0 0 1 0-1.414z"
          clip-rule="evenodd"
        ></path>
      </svg>
    </button>
    <label for="newFolderName" class="block text-sm font-medium text-gray-700"
      >Create new folder:</label
    >
    <input
      name="newFolderName"
      id="newFolderName"
      placeholder="Name of the folder..."
      class="mt-2 p-2 border rounded w-full"
    />
    <button type="submit" class="mt-4 bg-blue-500 text-white p-2 rounded">
      Create folder
    </button>
  </form>
</div>

<% if(locals.folder){ %>
<div
  id="renameFolderFormContainer"
  class="hidden fixed inset-0 flex items-center justify-center bg-gray-900 bg-opacity-50"
>
  <form
    id="renameFolderForm"
    action="/folders/rename/<%=folder.id  %>"
    method="post"
    class="relative flex flex-col bg-white p-6 rounded-lg shadow-md"
  >
    <button
      type="button"
      onclick="hideRenameFolderForm()"
      class="absolute top-2 right-2 text-gray-500 hover:text-gray-700 focus:outline-none"
    >
      <svg
        class="w-8 h-8"
        aria-hidden="true"
        fill="currentColor"
        viewBox="0 0 20 20"
      >
        <path
          fill-rule="evenodd"
          d="M6.293 6.293a1 1 0 0 1 1.414 0L10 8.586l2.293-2.293a1 1 0 1 1 1.414 1.414L11.414 10l2.293 2.293a1 1 0 0 1-1.414 1.414L10 11.414l-2.293 2.293a1 1 0 0 1-1.414-1.414L8.586 10 6.293 7.707a1 1 0 0 1 0-1.414z"
          clip-rule="evenodd"
        ></path>
      </svg>
    </button>
    <label
      for="renameFolderName"
      class="block text-sm font-medium text-gray-700"
      >Rename folder:</label
    >
    <input
      name="renameFolderName"
      id="renameFolderName"
      placeholder="New name..."
      class="mt-2 p-2 border rounded w-full"
    />
    <button type="submit" class="mt-4 bg-blue-500 text-white p-2 rounded">
      Rename folder
    </button>
  </form>
</div>
<div
  id="deleteFolderFormContainer"
  class="hidden fixed inset-0 flex items-center justify-center bg-gray-900 bg-opacity-50"
>
  <form
    id="deleteFolderForm"
    action="/folders/delete/<%=folder.id  %>"
    method="post"
    class="relative flex flex-col bg-white p-6 rounded-lg shadow-md"
  >
    <button
      type="button"
      onclick="hideDeleteFolderForm()"
      class="absolute top-2 right-2 text-gray-500 hover:text-gray-700 focus:outline-none"
    >
      <svg
        class="w-8 h-8"
        aria-hidden="true"
        fill="currentColor"
        viewBox="0 0 20 20"
      >
        <path
          fill-rule="evenodd"
          d="M6.293 6.293a1 1 0 0 1 1.414 0L10 8.586l2.293-2.293a1 1 0 1 1 1.414 1.414L11.414 10l2.293 2.293a1 1 0 0 1-1.414 1.414L10 11.414l-2.293 2.293a1 1 0 0 1-1.414-1.414L8.586 10 6.293 7.707a1 1 0 0 1 0-1.414z"
          clip-rule="evenodd"
        ></path>
      </svg>
    </button>
    <p class="mt-2 p-2 w-full">Are you sure you want to delete this folder?</p>
    <button type="submit" class="mt-4 bg-red-500 text-white p-2 rounded">
      Delete folder
    </button>
  </form>
</div>
<% } %>
<script>
  function submitForm() {
    document.getElementById("uploadForm").submit();
  }
  function showNewFolderForm() {
    document
      .getElementById("newFolderFormContainer")
      .classList.remove("hidden");
  }
  function hideNewFolderForm() {
    document.getElementById("newFolderFormContainer").classList.add("hidden");
  }
  function showRenameFolderForm() {
    document
      .getElementById("renameFolderFormContainer")
      .classList.remove("hidden");
  }
  function hideRenameFolderForm() {
    document
      .getElementById("renameFolderFormContainer")
      .classList.add("hidden");
  }
  function showDeleteFolderForm() {
    document
      .getElementById("deleteFolderFormContainer")
      .classList.remove("hidden");
  }
  function hideDeleteFolderForm() {
    document
      .getElementById("deleteFolderFormContainer")
      .classList.add("hidden");
  }
</script>
